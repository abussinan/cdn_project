proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=l2_cache:10m inactive=3m max_size=1g;

    server {
        listen 80;

        # Resolve the origin_server hostname to its Docker internal IP
        resolver 127.0.0.11 valid=5s; # Docker's embedded DNS resolver

        # --- Specific location for CSS files (no caching) ---
        location ~* \.css$ {
            add_header X-Cache-Status "CSS - Not Cached";
            proxy_no_cache 1;
            proxy_cache_bypass 1;
            proxy_pass http://origin_server:80; # Pass to origin server
        }

        # --- Specific location for JPG files (L2 caching rules) ---
        location ~* \.jpg$ {
            proxy_cache l2_cache;
            proxy_cache_valid 200 3m; # Cache 200 OK responses for 3 minutes
            proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
            proxy_cache_min_uses 1; # Cache after the first request
            add_header X-Cache-Status $upstream_cache_status;
            proxy_pass http://origin_server:80; # Pass to origin server
        }

        # --- General location (L2 caching for everything else) ---
        location / {
            proxy_pass http://origin_server:80; # Pass to origin server

            # General caching settings
            proxy_cache l2_cache;
            proxy_cache_valid 200 10m; # Cache general content for 10 minutes
            proxy_cache_use_stale error timeout updating http_500 http_502 http_503 http_504;
            add_header X-Cache-Status $upstream_cache_status;
        }
}